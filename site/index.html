<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kalkulátor kurzov</title>
</head>
<body>
  <h1>Kalkulátor kurzov zo Sportnet</h1>

  <label for="matchUrl">Zadaj URL zápasu:</label><br>
  <input type="text" id="matchUrl" size="80"
         value="https://sportnet.sme.sk/futbalnet/z/ssfz/zapas/686e1e6d35a9a4cf024e1a5e/">
  <button id="btnFetch">Zisti kurzy</button>

  <hr>

  <div id="result"></div>

  <script>
    document.getElementById('btnFetch').addEventListener('click', async () => {
      const url = document.getElementById('matchUrl').value.trim();
      if (!url) {
        alert('Zadaj URL zápasu!');
        return;
      }
      document.getElementById('result').innerHTML = '<p>Načítavam...</p>';
      try {
        const res = await fetch(`http://localhost:3000/api/match?url=${encodeURIComponent(url)}`);
        if (!res.ok) throw new Error('Chyba pri načítaní API');
        const data = await res.json();
        console.log(data);

        const out = [];
        out.push(`<h2>${data.parsed.teams.home || 'Domáci'} vs ${data.parsed.teams.away || 'Hostia'}</h2>`);
        if (data.parsed.date) out.push(`<p>Dátum: ${data.parsed.date}</p>`);
        if (data.parsed.score) out.push(`<p>Skóre: ${data.parsed.score}</p>`);

        out.push('<h3>Kurzy:</h3>');
        out.push(`<ul>
          <li>Domáci: ${data.estimate.odds.home}</li>
          <li>Remíza: ${data.estimate.odds.draw}</li>
          <li>Hostia: ${data.estimate.odds.away}</li>
        </ul>`);

        out.push('<h3>Interné parametre:</h3>');
        out.push(`<p>λ domáci: ${data.estimate.lambdaHome}, λ hostia: ${data.estimate.lambdaAway}</p>`);
        out.push(`<p>Poznámky: ${data.estimate.note.join('; ')}</p>`);

        document.getElementById('result').innerHTML = out.join('');
      } catch (err) {
        document.getElementById('result').innerHTML = `<p style="color:red;">Chyba: ${err.message}</p>`;
      }
    });
  </script>
</body>
</html>